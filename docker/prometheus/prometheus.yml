# ============================================================================
# üìà CONFIGURA√á√ÉO PROMETHEUS - MICROSERVI√áO RESULTADOS
# ============================================================================
# 
# Configura√ß√£o de coleta de m√©tricas do microservi√ßo resultados:
# - Scraping do actuator/prometheus endpoint
# - M√©tricas de sistema e aplica√ß√£o
# - Configura√ß√£o de alertas b√°sicos
# - Reten√ß√£o otimizada
# ============================================================================

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'resultados-microservice-monitor'

# Configura√ß√£o de alertas (opcional)
rule_files:
  # - "rules/*.yml"

# Configura√ß√µes de scraping
scrape_configs:
  # M√©tricas do Prometheus pr√≥prio
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Microservi√ßo Resultados
  - job_name: 'resultados-microservice'
    metrics_path: '/actuator/prometheus'
    scrape_interval: 10s
    static_configs:
      - targets: ['resultados-service:8082']
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: resultados-service:8082

  # M√©tricas do MySQL (se mysqld_exporter estiver dispon√≠vel)
  - job_name: 'mysql'
    static_configs:
      - targets: ['resultados-mysql:3306']
    metrics_path: '/metrics'
    scrape_interval: 30s
    # Opcional: adicionar mysqld_exporter

  # M√©tricas do Redis (se redis_exporter estiver dispon√≠vel)
  - job_name: 'redis'
    static_configs:
      - targets: ['resultados-redis:6379']
    metrics_path: '/metrics'  
    scrape_interval: 30s
    # Opcional: adicionar redis_exporter

  # Node Exporter (m√©tricas de sistema)
  - job_name: 'node'
    static_configs:
      - targets: ['localhost:9100']
    # Opcional: adicionar node_exporter

# Configura√ß√£o de storage
storage:
  tsdb:
    retention.time: 7d
    retention.size: 1GB